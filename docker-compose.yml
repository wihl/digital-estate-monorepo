services:
  backend:
    build:
      context: .
      dockerfile: apps/desktop-private/backend/Dockerfile
    ports:
      - "8000:8000"
    volumes:
      # 1. Sync the Backend Code
      - ./apps/desktop-private/backend:/monorepo/apps/desktop-private/backend
      # 2. Sync the Shared Packages (Critical for editing Contracts!)
      - ./packages:/monorepo/packages
    environment:
      - SSD_MOUNT_PATH=/data
      - TRANSCRIPTION_PROVIDER=local # Change to 'gemini' to use Cloud
      # - GEMINI_API_KEY=your_key_here
      - PYTHONPATH=/app/packages/contracts/src:/app/packages/ingest-logic/src:$PYTHONPATH
    command: uvicorn main:app --host 0.0.0.0 --port 8000 --reload
